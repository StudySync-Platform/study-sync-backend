# Post-related GraphQL types, inputs, and mutations.

"Visibility enum mirrors App\\Enums\\Visibility"
enum Visibility {
  public
  private
  room_only
  friends
  custom
}

"""
Input for creating a Post.
- visibility must match the PHP enum App\\Enums\\Visibility
- type is a free-form string like 'text', 'image', 'poll', etc.
"""
input CreatePostInput {
  room_id: ID
  content: String!
  media_urls: [String!]
  visibility: Visibility!
  type: String!
}

"Post model. Matches App\\Models\\Post casts/fillables."
type Post {
  id: ID!
  author_id: ID!
  room_id: ID
  content: String!
  media_urls: [String!]
  visibility: Visibility!
  type: String!
  created_at: DateTime!
  updated_at: DateTime!

  author: User @belongsTo
  room: Room @belongsTo
  comments: [PostComment!]! @hasMany
  reactions: [PostReaction!]! @hasMany
}

extend type Query {
  posts(
    first: Int
    page: Int
    author_id: ID @where(key: "author_id")
    room_id: ID @where(key: "room_id")
    visibility: Visibility @where(key: "visibility")
    orderBy: [OrderByClause!] @orderBy
  ): [Post!]!
    @paginate(type: "PAGINATOR", model: "App\\Models\\Post")
}


# If you don't already have these:
input OrderByClause {
  column: String!
  order: SortOrder = ASC
}
enum SortOrder { ASC DESC }
